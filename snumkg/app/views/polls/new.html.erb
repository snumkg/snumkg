<div class="poll_box">
<div id="poll_form">
  일반<%= radio_button_tag "poll_type", "일반", true %> 
  익명<%= radio_button_tag "poll_type", "익명", false %>
  <%= text_field_tag "poll_title", nil, :placeholder => "설문조사 제목을 입력하세요.." %>
  <a href="#" id="add_option" class="btn">옵션추가</a>
  <a href="#" id="remove_option" class="btn">옵션제거</a>
  <div class="option_box">
    <%= text_field_tag "poll_option[0]" %>
  </div>

</div>
<a href="#" id="close" class="btn">설문조사 생성</a>
</div>

<script>
  $("#add_option").click(function(){
    var options = $(".option_box input");
    var num = options.length;
    $(".option_box").append('<input id="poll_option_'+num+'" name="poll_option['+num+']" type="text"></input>');
  });

  $("#remove_option").click(function(){
    var num = $(".option_box input").length;

    if(num == 1){
      //최소 한개의 옵션은 포함되어야 함
      }else{
      $(".option_box").find("input:last").detach();
    }
  });

  $("#close").click(function(){
    var doc = window.opener.document;
    var title = $("#poll_title").val();
    $(doc).find(".poll_hidden_box").append($("#poll_form")); 
    $(doc).find(".poll_box").append('<div>'+title +' <a href="#">삭제</a></div>');
    window.close();
  });
  
</script>
