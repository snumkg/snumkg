<% content_for :head do %>
  <%= javascript_include_tag :user %>
  <%= javascript_include_tag "jquery.color" %>
<% end %>


<div id="nav_container">
  <ul id="my_info">
    <li>
    <%= link_to "홈으로", root_path %>
    </li>
    <% if current_user %>
      <% if current_user.admin? %>
        <li>
        <%= link_to "관리자페이지", admin_path %>
        </li>
      <% end %>
      <li>
      <%= link_to "쪽지[#{current_user.message_count}]", messages_path(type: "receive") %>
      </li>
      <li>
      <%= link_to "알림[#{current_user.new_alarm_count}]",user_alarms_path, id: "alarm_link", :remote => true %>
      <ul id="alarm_list">

      </ul>
      </li>
      <li>
      <%= image_tag picture_path(type: "profile", id: current_user.id, :thumb => "thumb"), :size => "25x25" %><%= link_to current_user.nickname, profile_path(current_user), class: "up" %>
      </li>
      <li><%= link_to "로그아웃", signout_path %></li>
    <% else %>
      <li>
      <ul>
        <%= link_to "로그인", "#", class: "login" %>
        <li class="login_box">
        <%= render 'shared/login_box' %>
        </li>
      </ul>
      </li>
      <li><a href="#myModal" data-toggle="modal">회원가입</a></li>
    <% end %>

  </ul>
  <div id="logo_box">LOGO</div>
  <div id="menu">
    <ul>
      <li>
      <%= link_to "누구나", group_path(1) %>
      </li>
      <li>
      <%= link_to "학번별 공간", "#" %>
      <ul class="sub_menu">
        <li>
        <%= link_to "모아보기", '/all' %>
        </li>
        <% for group in @groups %>
          <% if group.group_type == "학번" %>
            <li>
            <%= link_to group.name, group_path(group) %>
            </li>
          <% end %>
        <% end %>
      </ul>
      </li>
      <li>
      <%= link_to "소꼬지", "#" %>
      </li>
      <li>
      <%= link_to "매일매일", "#" %>
      </li>
      <li>
      <%= link_to "채팅", "#" %>
      </li>
    </ul>
  </div>
</div>


<script>
  //alarm ajax

  $(function(){

    $("#alarm_link").click(function(){

      $(this).css("visibility","visible");

      
      $.ajax({
        url: '/alarms',
        success: function(data){
          $("#alarm_list").html("")
                          .append($(data).find("#alarm_list_ajax").html())
                          .css("visibility","visible");


                          $("#alarm_list li.new").css("background", "#fee");
        
        }
      });
      
    });
  });
</script>
